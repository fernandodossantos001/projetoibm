package br.com.deschateie.bo;


import java.util.ArrayList;
import java.util.List;

import br.com.deschateie.beans.PsiOnline;
import br.com.deschateie.beans.Voluntario;
import br.com.deschateie.dao.PsiOnlineDAO;
import br.com.deschateie.dao.VoluntarioDAO;

/**
 *  Classe para validar os dados para tebela T_SCP_VOLUNTARIO
 * possui métodos para criar,pesquisar,alterar e excluir um PsiOnline
 * @author Deschateie
 * @since 1.0
 * @version 1.0
 * @see PsiOnline
 * @see PsiOnlineDAO
 */
public class VoluntarioBO {

	public static Voluntario pesquisarVoluntario(int codVoluntario)throws Exception {
		if(codVoluntario <1) {
			return new Voluntario();
		}
		
		if(codVoluntario>99999) {
			return new Voluntario();
		}
		
		VoluntarioDAO dao = new VoluntarioDAO();
		Voluntario vo = dao.consultarVoluntario(codVoluntario);
		dao.fechar();
		return vo;
		 
		
	}

	public static String novoVoluntario(Voluntario v,boolean ehValido)throws Exception{
		if (v.getCodVoluntario()<0) {
			return "Codigo voluntario invalido";
		}
		
		if(v.getCodVoluntario()>99999) {
			return "Codigo muito grande";
		}
		
		if (v.getFormacao().length() < 1) {
			return "o campo formacao nao pode estar vazio";
		}
		
		if (v.getFormacao().length()>60) {
			return "formacao muito grande";
		}
		
		
		if (v.getPeriodo().length()<0) {
			return "o campo perido nao pode estar vazio";
		}
		
		if(v.getPeriodo().length()> 40) {
			return "periodo muito grande ";
		}
		
		if (v.getComentario().length()<0) {
			return "o campo comentario nao pode estar vazio";
		}
		
		if (v.getComentario().length()>80) {
			return "comentario muito grande";
		}
		
		if(v.getTelefone()<0) {
			return "o campo telefone não pode estar vazio";
		}
		if(v.getTelefone()>99999999999l) {
			return "telefone muito grande";
		}
		
		VoluntarioDAO dao = new VoluntarioDAO();
		Voluntario volu = dao.consultarVoluntario(v.getCodVoluntario());

		if(volu.getRg().equalsIgnoreCase(v.getRg())) {
			dao.fechar();
			return "RG já existente";
		}
		
		if(volu.getCpf()== v.getCpf()) {
			dao.fechar();
			return "CPF já existente";
		}
		
		
		v.setNivelPermissao(2);
		
		if (!ehValido) {
			String status = UsuarioBO.novoUsuario(v);		
			if (!status.equals( "Usuário cadastrado com sucesso")) {
				
				return status;
			}
		}
		
		UsuarioBO.alterarNivelAcesso(v);
		
		dao.gravarVoluntario(v);
		return "Cadastrado com sucesso";
	}

	public static String  excluirVoluntario(int codVoluntario)throws Exception {
		if(codVoluntario <0 ) {
			return "codigo invalido";
		}
		
		if (codVoluntario >99999) {
			return "codigo muito grande";
		}
		
		
		Voluntario v = VoluntarioBO.pesquisarVoluntario(codVoluntario);
		
		if(v.getCodVoluntario()<1) {
			return "Voluntario nao encontrado";
		}
		 
		VoluntarioDAO dao  = new VoluntarioDAO();
		String status = dao.excluirVoluntario(codVoluntario);
		
		dao.fechar();
		return status;
	}

	public static String alterarDadosVoluntario(Voluntario v)throws Exception{
		
		if (v.getCodVoluntario()<0) {
			return "Codigo voluntario invalido";
		}
		
		if(v.getCodVoluntario()>99999) {
			return "Codigo muito grande";
		}
		
		if (v.getFormacao().length() < 1) {
			return "o campo formacao nao pode estar vazio";
		}
		
		if (v.getFormacao().length()>60) {
			return "formacao muito grande";
		}
		
		
		if (v.getPeriodo().length()<0) {
			return "o campo perido nao pode estar vazio";
		}
		
		if(v.getPeriodo().length()> 40) {
			return "periodo muito grande ";
		}
		
		if (v.getComentario().length()<0) {
			return "o campo comentario nao pode estar vazio";
		}
		
		if (v.getComentario().length()>80) {
			return "comentario muito grande";
		}
		
		if(v.getTelefone()<0) {
			return "o campo telefone não pode estar vazio";
		}
		if(v.getTelefone()>99999999999l) {
			return "telefone muito grande";
		}
		
		VoluntarioDAO dao = new VoluntarioDAO();

		Voluntario volu = new Voluntario();
		volu = dao.consultarVoluntario(v.getCodVoluntario());
		
		if(v.getCpf() != volu.getCpf()) {
			if(v.getCpf() == dao.consultarVoluntarioCpf(v.getCpf()).getCpf()) {
				dao.fechar();
				return "cpf já existe";			}
		}
		
		
		
		String status = UsuarioBO.AlterarDadosUsuario(v);
		
		if (!status.equals( "Usuário alterado com Sucesso")) {
			return status;
		}
		
		
		UsuarioBO.alterarNivelAcesso(v);
		
		dao.alterarDadosVoluntario(v);
		dao.fechar();
		return "Alterado com sucesso";
	}

	public static List<Voluntario> pesquisarVoluntarioTemporarios()throws Exception{
	List<Voluntario> listaVoluntario = new ArrayList<Voluntario>();
	VoluntarioDAO dao = new VoluntarioDAO();
	listaVoluntario = dao.consultarVoluntario();
	dao.fechar();
	return listaVoluntario;
	}
}
