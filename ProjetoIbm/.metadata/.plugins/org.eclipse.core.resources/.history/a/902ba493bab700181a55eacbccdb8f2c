package br.com.deschateie.bo;

import br.com.deschateie.beans.Endereco;
import br.com.deschateie.dao.EnderecoDAO;

public class EnderecoBO {
	
	
	public static String novoEnderecoPsicologo(Endereco endereco)throws Exception {
		
		
		//padronizacao
		endereco.setAll(endereco.getCdEndereco(),
						endereco.getCdAtendente(),
						endereco.getTipo().toUpperCase(),
						endereco.getLogradouro().toUpperCase(),
						endereco.getNumero(),
						endereco.getComplemento().toUpperCase(),
						endereco.getCep(),
						endereco.getBairro().toUpperCase(),
						endereco.getCidade().toUpperCase(),
						endereco.getUf().toUpperCase().trim().substring(0, 1),
						endereco.getPais().toUpperCase()
						);
		
		if(endereco.getTipo().length()>20) {
			return "Quantidade de caracterdes de  Tipo muito grande";
		}
		
		if (endereco.getLogradouro().length()>60) {
			return "Quantidade de caracterdes de  Logradouro muito grande";
		}
		
		if(endereco.getNumero().length()>20) {
			return "Número muito grande";
		}
		
		if (endereco.getComplemento().length()>10) {
			return "Quantidade de caracterdes de  Complemento muito grande";
		}
		
		if (endereco.getCep()>99999999) {
			return "Número de CEP muito grande";
		}
		
		if (endereco.getBairro().length()>30) {
			return "Quantidade de caracterdes de Bairro muito grande";
		}
		
		if (endereco.getCidade().length()>30) {
			return "Quantidade de caracterdes de Cidade muito grande";
			
		}
		
		if (endereco.getUf().length()>2) {
			return "Quantidade de caracterdes de  UF muito grande";
			
		}
		
		if (endereco.getCdAtendente()>99999) {
			return "Código do Atendente inválido, excede a quantidade de caracteres permitida";
		}
		
		if (endereco.getCdAtendente()<1) {
			return "Atendente não existe";
		}
		
		if(endereco.getCdEndereco()<1) {
			return "código inválido";
		}
		
		if(endereco.getCdEndereco()>99999) {
			return "Código do endereco inválido, excede a quantidade de caracteres permitida";
		}
		
		
		if(endereco.getTipo().equals(null)) {
			return "O campo tipo não pode estar vazio";
		}
		
		if (endereco.getLogradouro().equals(null)) {
			return "O campo logradouro não pode estar vazio";
		}
		
		if(endereco.getNumero().equals(null)) {
			return "O campo numero não pode estar vazio";
		}
		
		
		
		if (endereco.getCep()== 0) {
			return "O campo Cep não pode estar vazio ";
		}
		
		if (endereco.getBairro().equals(null)) {
			return "O campo bairro não pode estar vazio";
		}
		
		if (endereco.getCidade().equals(null)) {
			return "O campo cidade não pode estar vazio";
			
		}
		
		if (endereco.getUf().equals(null)) {
			return "O campo uf não pode estar vazio";
		}	
		
		

		EnderecoDAO dao = new EnderecoDAO();
		Endereco ende = dao.consultarPorCepPsicologo(endereco.getCep());
		String msg = null;
		if(ende.getCdEndereco()==0) {
			msg = dao.gravarDadosPsicologo(endereco);
			dao.fechar();
			return msg;
		}
		return "Endereco Já existente";
	}

	public static String novoEnderecoVoluntario(Endereco endereco)throws Exception {

		
		
		//padronizacao
		endereco.setAll(endereco.getCdEndereco(),
						endereco.getCdAtendente(),
						endereco.getTipo().toUpperCase(),
						endereco.getLogradouro().toUpperCase(),
						endereco.getNumero(),
						endereco.getComplemento().toUpperCase(),
						endereco.getCep(),
						endereco.getBairro().toUpperCase(),
						endereco.getCidade().toUpperCase(),
						endereco.getUf().toUpperCase().trim().substring(0, 1),
						endereco.getPais().toUpperCase()
						);
		
		if(endereco.getCdEndereco()<1) {
			return "código inválido";
		}
		
		if(endereco.getCdEndereco()>99999) {
			return "Código do endereco inválido, excede a quantidade de caracteres permitida";
		}
		
		if(endereco.getTipo().length()>20) {
			return "Quantidade de caracterdes de  Tipo muito grande";
		}
		
		if (endereco.getLogradouro().length()>60) {
			return "Quantidade de caracterdes de  Logradouro muito grande";
		}
		
		if(endereco.getNumero().length()>20) {
			return "Número muito grande";
		}
		
		if (endereco.getComplemento().length()>10) {
			return "Quantidade de caracterdes de  Complemento muito grande";
		}
		
		if (endereco.getCep()>99999999) {
			return "Número de CEP muito grande";
		}
		
		if (endereco.getBairro().length()>30) {
			return "Quantidade de caracterdes de Bairro muito grande";
		}
		
		if (endereco.getCidade().length()>30) {
			return "Quantidade de caracterdes de Cidade muito grande";
			
		}
		
		if (endereco.getUf().length()>2) {
			return "Quantidade de caracterdes de  UF muito grande";
			
		}
		
		if (endereco.getCdAtendente()>99999) {
			return "Código do Atendente inválido";
		}
		
		if (endereco.getCdAtendente()<1) {
			return "Atendente não existe";
		}
		
		
		if(endereco.getTipo().equals(null)) {
			return "O campo tipo não pode estar vazio";
		}
		
		if (endereco.getLogradouro().equals(null)) {
			return "O campo logradouro não pode estar vazio";
		}
		
		if(endereco.getNumero().equals(null)) {
			return "O campo numero não pode estar vazio";
		}
		
		
		
		if (endereco.getCep()== 0) {
			return "O campo Cep não pode estar vazio não pode estar vazio";
		}
		
		if (endereco.getBairro().equals(null)) {
			return "O campo bairro não pode estar vazio";
		}
		
		if (endereco.getCidade().equals(null)) {
			return "O campo cidade não pode estar vazio";
			
		}
		
		if (endereco.getUf().equals(null)) {
			return "O campo uf não pode estar vazio";
		}	
		
		

		EnderecoDAO dao = new EnderecoDAO();
		Endereco ende = dao.consultarPorCepVoluntario(endereco.getCep());
		String msg = null;
		if(ende.getCdEndereco()==0) {
			msg = dao.gravarDadosPsicologo(endereco);
			dao.fechar();
			return msg;
		}
		return "Endereco Já existente";
	}

	
	public static String pesquisarEnderecoPsicologo(int cep)throws Exception{
		Endereco endereco = new Endereco();
		
		if(cep < 1) {
			return "cep inválido";
		}
		if(cep >99999999) {
			return "Quantidade de caracterdes do CEP muito grande";
		}
		
		
		EnderecoDAO dao = new EnderecoDAO();
		
		
		
		
		endereco = dao.consultarPorCepPsicologo(cep);
		
		if(endereco.getCdAtendente()==0) {
			return "Não foi possivel encontrar nenhum endereco usando o cep " + cep;
		}
		dao.fechar();
		return "Endereco Encontrado" + endereco.getAll();
		
	
	}

	public static String pesquisarPorCepVoluntario(int cep)throws Exception{
		Endereco endereco = new Endereco();
		if(cep < 1) {
			return "cep inválido";
		}
		if(cep >99999999) {
			return "Quantidade de caracterdes do CEP muito grande";
		}
		
		
		EnderecoDAO dao = new EnderecoDAO();
		
		
		
		
		endereco = dao.consultarPorCepVoluntario(cep);
		
		if(endereco.getCdAtendente()==0) {
			return "Não foi possivel encontrar nenhum endereco usando o cep :" + cep;
		}
		dao.fechar();
		return "Endereco Encontrado" + endereco.getAll();
		
	
	}

	public static String excluirEnderecoPsicologo(int cep)throws Exception{
		if(cep < 0) {
			return "cep inválido";
		}
		
		if(cep > 99999999) {
			return "quantidade de caracteres ultrapassa o permitido ";
		}
		
		EnderecoDAO dao = new EnderecoDAO();
		Endereco endereco = dao.consultarPorCepPsicologo(cep);
		
		if(endereco.getCdEndereco()==0) {
			return "não foi possivel localizar um endereco com esse cep para ser apagado";
		}
		
		dao.apagarEndereco(cep);
		dao.fechar(); 
		return "O endereco foi apagado com sucesso" ;
	}

	

	public static String excluirEnderecoVoluntario(int cdEndereco)throws Exception{
		if(cdEndereco < 0) {
			return "código endereco inválido";
		}
		
		if(cdEndereco > 999999) {
			return "quantidade de caracteres ultrapassa o permitido ";
		}
		
		EnderecoDAO dao = new EnderecoDAO();
		Endereco endereco = dao.consultarPorPsicologo(cdEndereco);
		
		if(endereco.getCdEndereco() == 0) {
			return "não foi possivel localizar um endereco com esse cep para ser apagado";
		}
		
		dao.apagarEndereco(cep);
		dao.fechar(); 
		return "O endereco foi apagado com sucesso" ;
	}

	public static String alterarDadosEnderecoPsicologo(Endereco endereco)throws Exception{
		
		if(endereco.getCdEndereco()<1) {
			return "código inválido";
		}
		
		if(endereco.getCdEndereco()>99999) {
			return "Código do endereco inválido, excede a quantidade de caracteres permitida";
		}
		if(endereco.getTipo().length()>20) {
			return "Quantidade de caracterdes de  Tipo muito grande";
		}
		
		if (endereco.getLogradouro().length()>60) {
			return "Quantidade de caracterdes de  Logradouro muito grande";
		}
		
		if(endereco.getNumero().length()>20) {
			return "Número muito grande";
		}
		
		if (endereco.getComplemento().length()>10) {
			return "Quantidade de caracterdes de  Complemento muito grande";
		}
		
		if (endereco.getCep()>99999999) {
			return "Número de CEP muito grande";
		}
		
		if (endereco.getBairro().length()>30) {
			return "Quantidade de caracterdes de Bairro muito grande";
		}
		
		if (endereco.getCidade().length()>30) {
			return "Quantidade de caracterdes de Cidade muito grande";
			
		}
		
		if (endereco.getUf().length()>2) {
			return "Quantidade de caracterdes de  UF muito grande";
			
		}
		
		if (endereco.getCdAtendente()>99999) {
			return "Código do Atendente inválido";
		}
		
		if (endereco.getCdAtendente()<1) {
			return "Atendente não existe";
		}
		
		
		if(endereco.getTipo().equals(null)) {
			return "O campo tipo não pode estar vazio";
		}
		
		if (endereco.getLogradouro().equals(null)) {
			return "O campo logradouro não pode estar vazio";
		}
		
		if(endereco.getNumero().equals(null)) {
			return "O campo numero não pode estar vazio";
		}
		
		
		
		if (endereco.getCep()== 0) {
			return "O campo Cep não pode estar vazio não pode estar vazio";
		}
		
		if (endereco.getBairro().equals(null)) {
			return "O campo bairro não pode estar vazio";
		}
		
		if (endereco.getCidade().equals(null)) {
			return "O campo cidade não pode estar vazio";
			
		}
		
		if (endereco.getUf().equals(null)) {
			return "O campo uf não pode estar vazio";
		}

		EnderecoDAO dao = new EnderecoDAO();
		Endereco ende = new Endereco();
		
		ende = dao.consultarPorPsicologo(endereco.getCdAtendente());
		
		if(ende.getCdEndereco()==0) {
			dao.fechar();
			return "código de endereco não encontrado";
		}
		
		
		String resp = dao.atualizarPsicologo(endereco.getCdAtendente(), endereco.getLogradouro(),
									endereco.getTipo(), endereco.getNumero(), endereco.getComplemento(),
									endereco.getCep(), endereco.getBairro(), endereco.getCidade(),
									endereco.getUf(), endereco.getPais());
		
		dao.fechar();
		return resp;
		
		
		
	}
	
	
	public static String alterarDadosEnderecoVoluntario(Endereco endereco)throws Exception{
		
		
		if(endereco.getCdEndereco()<1) {
			return "código inválido";
		}
		
		if(endereco.getCdEndereco()>99999) {
			return "Código do endereco inválido, excede a quantidade de caracteres permitida";
		}
		
		if(endereco.getTipo().length()>20) {
			return "Quantidade de caracterdes de  Tipo muito grande";
		}
		
		if (endereco.getLogradouro().length()>60) {
			return "Quantidade de caracterdes de  Logradouro muito grande";
		}
		
		if(endereco.getNumero().length()>20) {
			return "Número muito grande";
		}
		
		if (endereco.getComplemento().length()>10) {
			return "Quantidade de caracterdes de  Complemento muito grande";
		}
		
		if (endereco.getCep()>99999999) {
			return "Número de CEP muito grande";
		}
		
		if (endereco.getBairro().length()>30) {
			return "Quantidade de caracterdes de Bairro muito grande";
		}
		
		if (endereco.getCidade().length()>30) {
			return "Quantidade de caracterdes de Cidade muito grande";
			
		}
		
		if (endereco.getUf().length()>2) {
			return "Quantidade de caracterdes de  UF muito grande";
			
		}
		
		if (endereco.getCdAtendente()>99999) {
			return "Código do Atendente inválido";
		}
		
		if (endereco.getCdAtendente()<1) {
			return "Atendente não existe";
		}
		
		
		if(endereco.getTipo().equals(null)) {
			return "O campo tipo não pode estar vazio";
		}
		
		if (endereco.getLogradouro().equals(null)) {
			return "O campo logradouro não pode estar vazio";
		}
		
		if(endereco.getNumero().equals(null)) {
			return "O campo numero não pode estar vazio";
		}
		
		
		
		if (endereco.getCep()== 0) {
			return "O campo Cep não pode estar vazio não pode estar vazio";
		}
		
		if (endereco.getBairro().equals(null)) {
			return "O campo bairro não pode estar vazio";
		}
		
		if (endereco.getCidade().equals(null)) {
			return "O campo cidade não pode estar vazio";
			
		}
		
		if (endereco.getUf().equals(null)) {
			return "O campo uf não pode estar vazio";
		}

		EnderecoDAO dao = new EnderecoDAO();
		Endereco ende = new Endereco();
		
		ende = dao.consultarPorVoluntario(endereco.getCdAtendente());
		
		if(ende.getCdEndereco() != 0) {
			
			
			
			String resp = dao.atualizarVoluntario(endereco.getCdAtendente(), endereco.getLogradouro(),
					endereco.getTipo(), endereco.getNumero(), endereco.getComplemento(),
					endereco.getCep(), endereco.getBairro(), endereco.getCidade(),
					endereco.getUf(), endereco.getPais());

			

			dao.fechar();
			return resp;
		}
		
		
		
		dao.fechar();
		return "código de endereco não encontrado";
		
		
		
	}
	
	
}
