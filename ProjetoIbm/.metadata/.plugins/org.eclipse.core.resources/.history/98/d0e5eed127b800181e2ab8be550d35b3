package br.com.deschateie.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import br.com.deschateie.beans.Paciente;
import br.com.deschateie.conexao.Conexao;

public class PacienteDAO {
	private Connection con;
	private PreparedStatement stmt;
	private ResultSet rs;
	
	public PacienteDAO()throws Exception {
		con= new Conexao().conectar();
	}
	
	
	public String gravarPaciente(Paciente p)throws Exception{
		stmt = con.prepareStatement("INSERT INTO T_SCP_PACIENTE"
									+ "(CD_PACIENTE, DS_CEP,NR_CPF,"
									+ "DS_HISTORICO,NR_CONSULTAS_REALIZADAS)"
									+ "VALUES(?,?,?,?,?)");
		
		stmt.setInt(1, p.getCodUsuario());
		stmt.setInt(2, p.getCep());
		stmt.setInt(3, p.getCpf());
		stmt.setString(4, p.getHistorico());
		stmt.setInt(5, p.getConsultasReazlizadas());
		stmt.executeUpdate();
		return "cadastrado com sucesso";
	}
	
	
	public String AlteraDadosPaciente(Paciente p)throws Exception{
		stmt = con.prepareStatement("UPDATE T_SCP_PACIENTE SET "
									+ "DS_CEP = ?,"
									+ "NR_CPF = ?,"
									+ "DS_HISTORICO = ?,"
									+ "NR_CONSULTAS_REALIZADAS = ?)"
									+ "WHERE CD_PACIENTE = ?");
		
		stmt.setInt(1, p.getCep());
		stmt.setInt(2, p.getCpf());
		stmt.setString(3, p.getHistorico());
		stmt.setInt(4, p.getConsultasReazlizadas());
		stmt.setInt(1,p.getCodPaciente());
		
		
		return stmt.executeUpdate() + "paciente alterado com sucesso";
	}


	public String excluirPaciente(int codPaciente) throws Exception{
		stmt = con.prepareStatement("DELETE FROM T_SCP_PACIENTE WHERE CD_PACIENTE=  ?");
		stmt.setInt(1, codPaciente);
		return "foi excluida " + stmt.executeUpdate() + " linha";
	}
	
	public String consultarPaciente(int codPaciente)throws Exception{
		stmt= con.prepareStatement("SELECT * FROM T_SCP_PACIENTE = ?");
		stmt.setInt(1, codPaciente);
		rs = stmt.executeQuery();
	}
}
